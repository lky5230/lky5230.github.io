webpackJsonp([1],{0:function(t,e){},"6VpE":function(t,e){},"7UNn":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tree-wrap"},[a("div",{staticClass:"tree"},[a("ul",{staticClass:"table-header"},t._l(t.column,function(e,i){return a("li",{key:i,staticClass:"nowrap",style:[{width:e.width?e.width+"px":1==e.delete||1==e.operate?"50px":"",flex:e.width?"none":1==e.delete||1==e.operate?"none":1,padding:1==e.operate||1==e.delete?"0px":"0px 10px","min-width":1==e.operate||1==e.delete?"40px":"100px"}]},[1==e.operate?[a("i",{staticClass:"fa fa-cogs",staticStyle:{transform:"translateX(-12px)"},attrs:{"aria-hidden":"true"}})]:1==e.delete?a("span",[a("button",{staticClass:"btn-delete",attrs:{title:"删除所选项",disabled:t.deleteBtnDisable},on:{click:t.removeLine}},[t.deleteBtnDisable?a("i",{staticClass:"fa fa-spin fa-spinner",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),t.deleteBtnDisable?t._e():a("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})])]):a("span",[e.isTree?a("span",[a("button",{staticClass:"btn-refresh",attrs:{title:"刷新",disabled:t.refreshBtnDisable},on:{click:t.refreshTable}},[a("i",{staticClass:"fa fa-refresh",class:{"fa-spin":!!t.refreshBtnDisable},attrs:{"aria-hidden":"true"}})]),t._v("\r\n                     \r\n                ")]):t._e(),t._v("\r\n                "+t._s(e.name)+"\r\n            ")]),t._v(" "),a("span",{staticClass:"w-resize",on:{mousedown:function(a){t.willDragStart(e,a)}}})],2)})),t._v(" "),a("ul",{staticClass:"table-body"},t._l(t.data,function(e,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"rowItem.show"}],key:e.id,staticClass:"table-body-li-wrap",on:{mouseleave:function(a){t.rowMouseLeave(e.id)},mouseenter:function(a){t.rowMouseEnter(e.id)}}},[1==t.uploading["uploading"+e.id]?a("div",{staticClass:"uploading"},[a("i",{staticClass:"fa fa-spin fa-spinner",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),a("div",{staticStyle:{display:"flex"}},t._l(t.column,function(i,n){return a("li",{key:n,staticClass:"table-body-li nowrap",class:{modify:1==e.modify},style:[{width:i.width?i.width+"px":1==i.delete||1==i.operate?"50px":"",flex:i.width?"none":1==i.delete||1==i.operate?"none":1,padding:1==i.operate?"0px":"0px 10px","padding-left":i.isTree?24*e.level+14+"px":1==i.operate?"0px":"14px",overflow:1==i.operate?"visible":"","min-width":1==i.operate||1==i.delete?"40px":"100px"}]},[i.isTree&&0!=e.children.length?[a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.icon,expression:"rowItem.icon == false"}],on:{click:function(a){t.expand(e,!0)}}},[a("i",{staticClass:"fa fa-plus-square",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.icon,expression:"rowItem.icon == true"}],on:{click:function(a){t.expand(e,!1)}}},[a("i",{staticClass:"fa fa-minus-square",attrs:{"aria-hidden":"true"}})])]:t._e(),t._v(" "),i.edit||i.isTree||i.operate||i.delete||"id"==i.prop?t._e():a("span",[t._v(" "+t._s(e[i.prop])+" ")]),t._v(" "),i.edit||i.isTree||i.operate||i.delete||"id"!=i.prop?t._e():a("span",[t._v(" "+t._s(t._f("timestamp__")(e[i.prop]))+" ")]),t._v(" "),i.edit?[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.operateStatus["status"+e.id],expression:"!operateStatus['status'+rowItem.id]"}],staticClass:"no-wrap",staticStyle:{"text-align":"left"},attrs:{title:e[i.prop]}},[t._v("\r\n                            "+t._s(e[i.prop])+"\r\n                        ")]),t._v(" "),a("input",{directives:[{name:"show",rawName:"v-show",value:t.operateStatus["status"+e.id],expression:"operateStatus['status'+rowItem.id]"}],style:{width:i.isTree?"auto":"100%"},attrs:{type:"text"},domProps:{value:t.lineValue["lineValue"+i.prop+e.id]},on:{input:function(a){t.inputEdit(e.id,i.prop,a)}}})]:t._e(),t._v(" "),i.operate?[a("span",{staticClass:"hover-btn",on:{mouseover:function(a){t.mouseHover(e.id,1)},mouseout:function(a){t.mouseHover(e.id,2)}}},[t._m(0,!0),t._v(" "),a("transition",{attrs:{name:"as"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.hoverBtn["hoverBtn"+e.id],expression:"hoverBtn['hoverBtn'+rowItem.id]"}],staticClass:"col-btn-group"},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.operateStatus["status"+e.id],expression:"!operateStatus['status'+rowItem.id]"}]},[a("button",{staticClass:"btn-edit",on:{click:function(a){t.operateBtn(e.id)}}},[a("i",{staticClass:"fa fa-pencil",attrs:{"aria-hidden":"true"}}),t._v(" 编辑\r\n                                        ")]),t._v(" "),a("button",{staticClass:"btn-add",on:{click:function(a){t.addLine(e.id,1)}}},[a("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}}),t._v(" 增加同级\r\n                                        ")]),t._v(" "),a("button",{staticClass:"btn-add",on:{click:function(a){t.addLine(e.id,2)}}},[a("i",{staticClass:"fa fa-plus-circle",attrs:{"aria-hidden":"true"}}),t._v(" 增加下级\r\n                                        ")]),t._v(" "),e.modify?a("button",{staticClass:"btn-upload",on:{click:function(a){t.upload(e.id)}}},[a("i",{staticClass:"fa fa-cloud-upload",attrs:{"aria-hidden":"true"}}),t._v(" 上传\r\n                                        ")]):t._e()]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!!t.operateStatus["status"+e.id],expression:"!!operateStatus['status'+rowItem.id]"}]},[a("button",{staticClass:"btn-confirm",on:{click:function(a){t.saveBtn(e.id)}}},[a("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}}),t._v(" 确认\r\n                                        ")]),t._v(" "),a("button",{staticClass:"btn-cancel",on:{click:function(a){t.cancel(e.id)}}},[a("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}}),t._v(" 撤销\r\n                                        ")])])])])],1)]:t._e(),t._v(" "),i.delete?[a("span",{staticClass:"checkbox-span",class:{active:t.checkboxControl["active"+e.id]},on:{click:function(a){t.checkbox_change(e.id)}}},[t.checkboxControl["active"+e.id]?a("i",{staticClass:"fa fa-check-circle",attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "),t.checkboxControl["active"+e.id]?t._e():a("i",{staticClass:"fa fa-circle-o",attrs:{"aria-hidden":"true"}})])]:t._e(),t._v(" "),e.modify&&0==n?[t._m(1,!0)]:t._e()],2)}))])})),t._v(" "),0==t.data.length?a("div",{staticClass:"no-data"},[a("i",{staticClass:"fa fa-file-o",attrs:{"aria-hidden":"true"}}),t._v("  数据为空\r\n    ")]):t._e()]),t._v(" "),t.treeLoading&&0!=t.data.length?a("div",{staticClass:"tree-loading"},[a("i",{staticClass:"fa fa-spinner fa-spin",attrs:{"aria-hidden":"true"}})]):t._e()])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"hover-btn-span"},[t._v("\r\n                                 "),a("i",{staticClass:"fa fa-pencil-square",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"modify-pin"},[a("span",{staticClass:"modify-pin-title"},[t._v("记得上传")]),t._v(" "),a("i",{staticClass:"fa fa-exclamation",attrs:{"aria-hidden":"true"}})])}],s={render:i,staticRenderFns:n};e.a=s},"84Yf":function(t,e){},EXDq:function(t,e,a){"use strict";var i=a("fDRT"),n=a("Up5l"),s=a("mPyB"),r=s(i.a,n.a,!1,null,null,null);e.a=r.exports},LV8r:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("test")],1)},n=[],s={render:i,staticRenderFns:n};e.a=s},M93x:function(t,e,a){"use strict";function i(t){a("84Yf")}var n=a("dYPY"),s=a("LV8r"),r=a("mPyB"),o=i,l=r(n.a,s.a,!1,o,null,null);e.a=l.exports},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("f0wq"),n=a("M93x"),s=a("/oTv"),r=a("6VpE"),o=(a.n(r),a("iOHE"));a.n(o);i.a.use(s.a),i.a.config.productionTip=!1,new i.a({el:"#app",template:"<App/>",components:{App:n.a}})},Sz5k:function(t,e,a){"use strict";function i(t){a("YooD")}var n=a("kq5j"),s=a("7UNn"),r=a("mPyB"),o=i,l=r(n.a,s.a,!1,o,"data-v-250d2370",null);e.a=l.exports},Up5l:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("tree-grid",{attrs:{columns:t.columns,rowdata:t.data,needUpdate:t.needUpdate,treeLoading:t.treeLoading},on:{refreshTable:t.refreshTable,uploadmodify:t.uploadmodify,uploaddelete:t.uploaddelete}})],1)},n=[],s={render:i,staticRenderFns:n};e.a=s},YooD:function(t,e){},dYPY:function(t,e,a){"use strict";var i=a("EXDq");e.a={name:"app",components:{test:i.a}}},fDRT:function(t,e,a){"use strict";var i=a("fjjs"),n=a.n(i),s=a("Sz5k");e.a={data:function(){return{columns:[{name:"ID",prop:"id",width:120},{name:"删除",delete:!0},{name:"name字段",prop:"name",width:260,isTree:!0,edit:!0},{name:"操作",operate:!0},{name:"level",prop:"level",width:120},{name:"url",prop:"url",edit:!0}],data:[],needUpdate:Date.now(),treeLoading:!1}},created:function(){var t=this;this.treeLoading=!0,this.$http.get("static/menu.json").then(function(e){setTimeout(function(){t.treeLoading=!1,t.data=e.data,t.needUpdate=Date.now()},1400)})},methods:{refreshTable:function(){var t=this;this.treeLoading=!0,this.$http.get("static/menu.json").then(function(e){setTimeout(function(){t.treeLoading=!1,t.data=e.data,t.needUpdate=Date.now()},1400)})},uploadmodify:function(t){var e=n()(t,3),a=e[0],i=e[1],s=e[2];console.log(a),setTimeout(function(){Math.random()>.4?i():s()},1100)},uploaddelete:function(t){var e=n()(t,3),a=e[0],i=e[1],s=e[2];console.log(a),setTimeout(function(){Math.random()>.1?i():s()},1100)}},components:{treeGrid:s.a}}},iOHE:function(t,e){},kq5j:function(t,e,a){"use strict";function i(t){var e=[].concat(_()(t)),a=0,i=[];if(0==e.length)return[];e.forEach(function(t){t.level>a&&(a=t.level)}),e=e.map(function(t){return t.children=[],t.show=!0,t});for(var n=0;n<=a;n++)!function(t){i[t]=[],e.forEach(function(e){e.level==t&&i[t].push(e)})}(n);for(var n=i.length-1;n>=0;n--)for(var s=0;s<i[n].length;s++)!function(t,e){if(0!=e)for(var a=e-1,n=0;n<i[a].length;n++)i[a][n].id==t.parentid&&(i[a][n].icon=!0,i[a][n].children.push(t))}(i[n][s],n);return i[0]}function n(t){function e(t){if(0!=t.children.length)for(var a=0;a<t.children.length;a++)i.push(t.children[a]),e(t.children[a])}for(var a=[].concat(_()(t)),i=[],n=0;n<a.length;n++)i.push(a[n]),e(a[n]);return i}var s=a("9PQg"),r=a.n(s),o=a("u6qr"),l=a.n(o),d=a("SUjy"),c=a.n(d),u=a("fjjs"),h=a.n(u),f=a("07sj"),p=a.n(f),v=a("34v0"),m=a.n(v),w=a("Sxqw"),_=a.n(w);e.a={name:"treeGrid",props:{columns:{require:!0,type:Array},rowdata:{require:!0,type:Array},needUpdate:{require:!0},treeLoading:{default:!1}},data:function(){return{column:[],data:[],data_format:null,operate:{},hoverBtn:{},operateStatus:{},uploading:{},lineValue:{},checkboxControl:{},deleteIdArr:[],deleteBtnDisable:!1,refreshBtnDisable:!1}},filters:{timestamp__:function(t){return-1!=(t+"").indexOf("__timestamp__")?" - ":t}},created:function(){this.column=[].concat(_()(this.columns))},watch:{needUpdate:function(){this.init()}},methods:{refreshTable:function(){this.refreshBtnDisable=!0,this.$emit("refreshTable")},init:function(){if(0!=this.rowdata.length){this.refreshBtnDisable=!1,this.data=n(i([].concat(_()(this.rowdata))));var t=m()({},this.data[0]);for(var e in t)t.hasOwnProperty(e)&&(t[e]="");this.data_format=t,this.initValue()}},initValue:function(){for(var t=[].concat(_()(this.data)),e=[].concat(_()(this.column)),a=0;a<t.length;a++){this.$set(this.checkboxControl,"active"+t[a].id,!1);for(var i=0;i<e.length;i++)1==e[i].edit&&this.$set(this.lineValue,"lineValue"+e[i].prop+t[a].id,t[a][e[i].prop])}},rowMouseEnter:function(t){this.$set(this.operate,"operate"+t,!0)},rowMouseLeave:function(t){this.$set(this.operate,"operate"+t,!1)},mouseHover:function(t,e){1==e?this.$set(this.hoverBtn,"hoverBtn"+t,!0):2==e&&this.$set(this.hoverBtn,"hoverBtn"+t,!1)},willDragStart:function(t,e){function a(e){n.moveClientX=e.clientX;for(var a=n.moveClientX-n.startClientX,i=[].concat(_()(n.column)),r=0;r<i.length;r++)if(i[r].prop==t.prop){i[r].width=1*s+1*a;break}n.column=i}function i(){window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",i)}if(void 0!=t.prop&&void 0!=t.width){this.startClientX=e.clientX,this.colItem=m()({},t);var n=this,s=t.width;window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",i),window.addEventListener("mousemove",a),window.addEventListener("mouseup",i)}},expand:function(t,e){for(var a=[].concat(_()(this.data)),i=null,n=0;n<a.length;n++)if(a[n].id==t.id){a[n].icon=e;for(var s=p.a,r=n,o=a[n].level;;){if(r++,i=r,void 0==a[r])break;if(0==e){if(!(a[r].level>o))break;a[r].show=!1}else{if(!(a[r].level>o))break;if(a[r].level>s)continue;a[r].level==s&&(s=p.a),0==a[r].icon&&(s=a[r].level),a[r].show=!0}}}return this.data=a,[i,a]},inputEdit:function(t,e,a){for(var i=[].concat(_()(this.data)),n=([].concat(_()(this.column)),0);n<i.length;n++)if(i[n].id==t){i[n].editing=!0;break}this.data=i,this.$set(this.lineValue,"lineValue"+e+t,a.target.value)},operateBtn:function(t){this.$set(this.operateStatus,"status"+t,!0)},saveBtn:function(t){for(var e=[].concat(_()(this.data)),a=[].concat(_()(this.column)),i=0;i<e.length;i++)if(e[i].id==t){1==e[i].editing&&(e[i].modify=!0);for(var n=0;n<a.length;n++)1==a[n].edit&&(e[i][a[n].prop]=this.lineValue["lineValue"+a[n].prop+t]);break}this.data=e,this.$set(this.operateStatus,"status"+t,!1)},cancel:function(t){for(var e=[].concat(_()(this.data)),a=[].concat(_()(this.column)),i=0;i<e.length;i++)if(e[i].id==t){for(var n=0;n<a.length;n++)1==a[n].edit&&(this.lineValue["lineValue"+a[n].prop+t]=e[i][a[n].prop]);break}this.$set(this.operateStatus,"status"+t,!1)},upload:function(t){function e(){for(var e=[].concat(_()(this.data)),a=([].concat(_()(this.column)),0);a<e.length;a++)if(e[a].id==t){e[a].modify=!1,e[a].editing=!1;break}this.data=e,this.$set(this.uploading,"uploading"+t,!1)}function a(){console.log("上传失败！"),this.$set(this.uploading,"uploading"+t,!1)}for(var i=[].concat(_()(this.data)),n=0;n<i.length;n++)i[n].id==t&&(this.$set(this.uploading,"uploading"+t,!0),this.$emit("uploadmodify",[i[n],e.bind(this),a.bind(this)]))},addLine:function(t,e){if(1==e){for(var a=[].concat(_()(this.data)),i=null,n=0;n<a.length;n++)a[n].id==t&&(i=a[n]);var s=this.expand(i,!1),r=h()(s,2),o=r[0],l=r[1],d=Date.now()+"__timestamp__";l.splice(o,0,m()({},this.data_format,{id:d,level:i.level,parentid:i.parentid,modify:!0,show:!0,children:[]})),this.$set(this.operateStatus,"status"+d,!0),this.data=l}else if(2==e){for(var u=[].concat(_()(this.data)),f=null,p=null,v=0;v<u.length;v++)u[v].id==t&&(u[v].children=[!0],f=u[v],f.icon=!0,p=v);var w=Date.now()+"__timestamp__;",b=this.expand(f,!0),g=h()(b,2),C=(g[0],g[1]);C.splice(c()(p)+1,0,m()({},this.data_format,{id:w,level:c()(f.level)+1,parentid:f.id,modify:!0,show:!0,children:[]})),this.$set(this.operateStatus,"status"+w,!0),this.data=C}},checkbox_change:function(t){var e=this,a=this.checkboxControl["active"+t];if(this.$set(this.checkboxControl,"active"+t,!a),a)!function(){for(var a=[].concat(_()(e.data)),i=0;i<a.length;i++)if(a[i].id==t){var n=function(){var t=function t(e){if(this.$set(this.checkboxControl,"active"+e.parentid,!1),e.parentid!=e.id)for(var i=0;i<a.length;i++)a[i].id==e.parentid&&t.call(this,a[i])},n=i,s=a[i].level;for(e.$set(e.checkboxControl,"active"+a[i].parentid,!1);(n++,void 0!=a[n])&&a[n].level>s;)e.$set(e.checkboxControl,"active"+a[n].id,!1);return t.call(e,a[i]),"break"}();if("break"===n)break}}();else for(var i=[].concat(_()(this.data)),n=0;n<i.length;n++)if(i[n].id==t){for(var s=n,r=i[n].level;(s++,void 0!=i[s])&&i[s].level>r;)this.$set(this.checkboxControl,"active"+i[s].id,!0);break}this.deleteIdArr=[];for(var o in this.checkboxControl)this.checkboxControl.hasOwnProperty(o)&&1==this.checkboxControl[o]&&this.deleteIdArr.push(o.split("active")[1])},removeLine:function(){function t(){var t=this,e=[].concat(_()(this.data)),a=[].concat(_()(this.deleteIdArr));a.map(function(t){return t+=""});for(var i=0;i<a.length;i++)this.$set(this.uploading,"uploading"+a[i],!1);var n=!0,s=!1,o=void 0;try{for(var d,c=l()(r()(this.checkboxControl));!(n=(d=c.next()).done);n=!0){var u=d.value,f=h()(u,2),p=f[0];f[1];!function(e,i){a.forEach(function(a){e.split("active")[1]==a&&delete t.checkboxControl[e]})}(p)}}catch(t){s=!0,o=t}finally{try{!n&&c.return&&c.return()}finally{if(s)throw o}}for(var v=e.filter(function(t){for(var e=0;e<a.length;e++)if(a[e]+""==t.id+"")return!1;return!0}),m=0;m<v.length;m++)void 0!=v[m+1]?v[m+1].level<=v[m].level&&(delete v[m].icon,v[m].children=[]):void 0==v[m+1]&&(delete v[m].icon,v[m].children=[]);this.deleteIdArr=[],this.deleteBtnDisable=!1,this.data=v}function e(){for(var t=0;t<this.deleteIdArr.length;t++)this.$set(this.uploading,"uploading"+this.deleteIdArr[t],!1);this.deleteBtnDisable=!1,alert("删除失败！")}var a=[].concat(_()(this.deleteIdArr));if(0!=a.length){this.deleteBtnDisable=!0;for(var i=0;i<a.length;i++)this.$set(this.uploading,"uploading"+a[i],!0);this.$emit("uploaddelete",[a,t.bind(this),e.bind(this)])}}}}}},["NHnr"]);
//# sourceMappingURL=app.9a4a39e28b49dca9c5b8.js.map